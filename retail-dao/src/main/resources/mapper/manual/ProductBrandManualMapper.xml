<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jzfq.retail.core.dao.manual.ProductBrandManualMapper">

    <resultMap id="BaseResultMap" type="com.jzfq.retail.bean.domain.ProductBrand" >
        <!--
         WARNING - @mbggenerated
         This element is automatically generated by MyBatis Generator, do not modify.
         This element was generated on Wed Jun 27 16:29:15 CST 2018.
       -->
        <id column="productBrand_id" property="id" jdbcType="INTEGER" />
        <result column="productBrand_name" property="name" jdbcType="VARCHAR" />
        <result column="productBrand_name_first" property="nameFirst" jdbcType="VARCHAR" />
        <result column="productBrand_image" property="image" jdbcType="VARCHAR" />
        <result column="productBrand_look_method" property="lookMethod" jdbcType="INTEGER" />
        <result column="productBrand_top" property="top" jdbcType="INTEGER" />
        <result column="productBrand_sort" property="sort" jdbcType="INTEGER" />
        <result column="productBrand_create_id" property="createId" jdbcType="INTEGER" />
        <result column="productBrand_create_time" property="createTime" jdbcType="TIMESTAMP" />
        <result column="productBrand_update_id" property="updateId" jdbcType="INTEGER" />
        <result column="productBrand_update_time" property="updateTime" jdbcType="TIMESTAMP" />
        <result column="productBrand_state" property="state" jdbcType="INTEGER" />
        <result column="productBrand_english_name" property="englishName" jdbcType="VARCHAR" />
        <result column="productBrand_alias" property="alias" jdbcType="VARCHAR" />
        <result column="productBrand_introduction" property="introduction" jdbcType="VARCHAR" />
        <result column="productBrand_eng_chs" property="engChs" jdbcType="VARCHAR" />
        <result column="productBrand_product_cate_id" property="productCateId" jdbcType="INTEGER" />
    </resultMap>

    <sql id="Base_Column_List" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Wed Jun 27 16:29:15 CST 2018.
        -->
        productBrand.id as productBrand_id, productBrand.name as productBrand_name, productBrand.name_first as productBrand_name_first,
        productBrand.image as productBrand_image, productBrand.look_method as productBrand_look_method,
        productBrand.top as productBrand_top, productBrand.sort as productBrand_sort, productBrand.create_id as productBrand_create_id,
        productBrand.create_time as productBrand_create_time, productBrand.update_id as productBrand_update_id,
        productBrand.update_time as productBrand_update_time, productBrand.state as productBrand_state,
        productBrand.english_name as productBrand_english_name, productBrand.alias as productBrand_alias,
        productBrand.introduction as productBrand_introduction, productBrand.eng_chs as productBrand_eng_chs,
        productBrand.product_cate_id as productBrand_product_cate_id
    </sql>

    <select id="findList" resultType="map" parameterType="com.jzfq.retail.bean.vo.req.ProductBrandSearchReq">
        SELECT
        productBrand.id AS id,
        productBrand.`name` AS name,
        productBrand.english_name AS englishName,
        productBrand.name_first AS nameFirst,
        productBrand.product_cate_id AS cateId,
        productCate.`name` AS cateName,
        productBrand.state as state
        FROM
        product_brand productBrand
        LEFT JOIN product_cate productCate ON productBrand.product_cate_id = productCate.id
        <where>
            <if test="cateId!=null">
                and productBrand.product_cate_id=#{productCateId}
            </if>
            <if test="name!=null">
                and productBrand.name like concat('%',#{name},'%')
            </if>
            <if test="englishName!=null">
                and productBrand.english_name like concat('%',#{englishName},'%')
            </if>
            <if test="state!=null">
                and productBrand.state = #{state}
            </if>
            <if test="state==null">
                and productBrand.state != 4
            </if>
        </where>
        ORDER BY productBrand.id desc
    </select>

    <update id="deleteByCateId" parameterType="java.lang.Integer">
        update product_brand set state = 4 where product_cate_id = #{cateId}
    </update>
</mapper>